<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Excel Assistant with Handsontable</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable@14.1.0/dist/handsontable.min.css">
    <style>
        #hot {
            margin-top: 1rem;
        }
    </style>
</head>
<body class="p-4 bg-light">

<div class="container">
    <h2 class="mb-4">ğŸ§® Excel Assistant</h2>

    <div class="toolbar d-flex gap-2 mb-3">
        <button class="btn btn-primary btn-sm" onclick="addRow()">í–‰ ì¶”ê°€</button>
        <button class="btn btn-danger btn-sm" onclick="deleteSelected()">í–‰ ì‚­ì œ</button>
        <button class="btn btn-success btn-sm" onclick="saveData()">ì €ì¥</button>
    </div>

    <div id="hot"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/handsontable@14.1.0/dist/handsontable.min.js"></script>
<script>
    const container = document.getElementById('hot');

    // ì´ˆê¸° ë°ì´í„°
    const data = [
        { ì„ íƒ: false, ì´ë¦„: 'ê¹€í˜„ëŒ€', ë¶€ì„œ: 'ì „ê¸°ì„¤ê³„íŒ€', ì—°ë½ì²˜: '010-1234-5678', ì§ê¸‰: 'ê³¼ì¥' },
    ];

    const hot = new Handsontable(container, {
        data: data,
        columns: [
            {
                data: 'ì„ íƒ',
                type: 'checkbox',
                className: 'htCenter'
            },
            {
                data: 'ì´ë¦„',
                type: 'text'
            },
            {
                data: 'ë¶€ì„œ',
                type: 'text'
            },
            {
                data: 'ì—°ë½ì²˜',
                type: 'text'
            },
            {
                data: 'ì§ê¸‰',
                type: 'dropdown',
                source: ['ì‚¬ì›', 'ëŒ€ë¦¬', 'ê³¼ì¥', 'ì°¨ì¥', 'ë¶€ì¥']
            }
        ],
        colHeaders: ['ì„ íƒ', 'ì´ë¦„', 'ë¶€ì„œ', 'ì—°ë½ì²˜', 'ì§ê¸‰'],
        rowHeaders: true,
        width: '100%',
        height: 400,
        licenseKey: 'non-commercial-and-evaluation',
        stretchH: 'all'
    });

    function addRow() {
        hot.alter('insert_row');
    }

    function deleteSelected() {
        const allData = hot.getData();
        const selectedRows = [];

        allData.forEach((row, index) => {
            if (row[0] === true) selectedRows.push(index);
        });

        // ì—­ìˆœìœ¼ë¡œ ì‚­ì œ (ì¸ë±ìŠ¤ ë°€ë¦¼ ë°©ì§€)
        selectedRows.reverse().forEach(rowIndex => {
            hot.alter('remove_row', rowIndex);
        });
    }

    function saveData() {
        const updatedData = hot.getData();
        console.log("ì €ì¥í•  ë°ì´í„°:", updatedData);
        alert('ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');

        // Spring Bootë¡œ ë³´ë‚¼ ë•ŒëŠ” fetch() ë“±ì„ ì‚¬ìš©í•˜ì—¬ JSON ì „ì†¡ ê°€ëŠ¥
        // fetch('/save', {
        //   method: 'POST',
        //   headers: { 'Content-Type': 'application/json' },
        //   body: JSON.stringify(updatedData)
        // });
    }
</script>
</body>
</html>
